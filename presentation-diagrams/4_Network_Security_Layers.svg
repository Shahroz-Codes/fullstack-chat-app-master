<svg viewBox="0 0 1200 1100" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" style="max-width: 1200px; max-height: 1100px; overflow: auto;">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#2d3748" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="600" y="40" font-size="32" font-weight="bold" text-anchor="middle" fill="#1a365d">Feature 4: Network Security Layers &amp; Encryption</text>

  <!-- Legend -->
  <rect x="50" y="70" width="1100" height="50" fill="#f0f4f8" stroke="#cbd5e0" stroke-width="2" rx="5"/>
  <text x="70" y="105" font-size="12" fill="#2d3748">Defense in Depth --&gt; TLS/SSL --&gt; JWT Authentication --&gt; Secure Headers --&gt; Network Protections</text>

  <!-- OSI Security Model -->
  <text x="150" y="160" font-size="16" font-weight="bold" fill="#1a365d">Security Across OSI Layers</text>

  <!-- Physical Layer -->
  <rect x="100" y="180" width="250" height="50" fill="#f7fafc" stroke="#cbd5e0" stroke-width="2" rx="5"/>
  <text x="225" y="210" font-size="12" text-anchor="middle" fill="#666" font-weight="bold">Physical Layer (1)</text>

  <!-- Data Link Layer -->
  <rect x="100" y="240" width="250" height="50" fill="#f7fafc" stroke="#cbd5e0" stroke-width="2" rx="5"/>
  <text x="225" y="265" font-size="12" text-anchor="middle" fill="#666" font-weight="bold">Data Link Layer (2)</text>

  <!-- Network Layer -->
  <rect x="100" y="300" width="250" height="50" fill="#fef3c7" stroke="#92400e" stroke-width="2" rx="5"/>
  <text x="225" y="325" font-size="12" text-anchor="middle" fill="#92400e" font-weight="bold">Network Layer (3)</text>
  <text x="225" y="340" font-size="10" text-anchor="middle" fill="#92400e">IPsec (optional)</text>

  <!-- Transport Layer -->
  <rect x="100" y="360" width="250" height="50" fill="#bee3f8" stroke="#2c5282" stroke-width="2" rx="5"/>
  <text x="225" y="385" font-size="12" text-anchor="middle" fill="#2c5282" font-weight="bold">Transport Layer (4)</text>
  <text x="225" y="400" font-size="10" text-anchor="middle" fill="#2c5282">TLS 1.3 Encryption</text>

  <!-- Session Layer -->
  <rect x="100" y="420" width="250" height="50" fill="#fae8ff" stroke="#581c87" stroke-width="2" rx="5"/>
  <text x="225" y="445" font-size="12" text-anchor="middle" fill="#581c87" font-weight="bold">Session Layer (5)</text>
  <text x="225" y="460" font-size="10" text-anchor="middle" fill="#581c87">WebSocket Sessions</text>

  <!-- Presentation Layer -->
  <rect x="100" y="480" width="250" height="50" fill="#fed7d7" stroke="#c53030" stroke-width="2" rx="5"/>
  <text x="225" y="505" font-size="12" text-anchor="middle" fill="#c53030" font-weight="bold">Presentation Layer (6)</text>
  <text x="225" y="520" font-size="10" text-anchor="middle" fill="#c53030">Data Encryption/JSON</text>

  <!-- Application Layer -->
  <rect x="100" y="540" width="250" height="50" fill="#c6f6d5" stroke="#22543d" stroke-width="2" rx="5"/>
  <text x="225" y="565" font-size="12" text-anchor="middle" fill="#22543d" font-weight="bold">Application Layer (7)</text>
  <text x="225" y="580" font-size="10" text-anchor="middle" fill="#22543d">JWT, HTTP Security</text>

  <!-- TLS Handshake Visualization -->
  <text x="450" y="160" font-size="16" font-weight="bold" fill="#1a365d">TLS 1.3 Handshake Process</text>

  <!-- Client -->
  <rect x="400" y="180" width="120" height="50" fill="#4299e1" stroke="#2b6cb0" stroke-width="2" rx="5"/>
  <text x="460" y="205" font-size="12" text-anchor="middle" fill="white" font-weight="bold">Client</text>

  <!-- Server -->
  <rect x="580" y="180" width="120" height="50" fill="#ed8936" stroke="#7c2d12" stroke-width="2" rx="5"/>
  <text x="640" y="205" font-size="12" text-anchor="middle" fill="white" font-weight="bold">Server</text>

  <!-- Handshake Steps -->
  <line x1="520" y1="205" x2="580" y2="205" stroke="#2d3748" stroke-width="3" marker-end="url(#arrowhead)"/>
  <rect x="530" y="185" width="40" height="20" fill="#e6fffa" stroke="#0f766e" stroke-width="1" rx="3"/>
  <text x="550" y="200" font-size="9" text-anchor="middle" fill="#0f766e" font-weight="bold">1</text>

  <line x1="580" y1="225" x2="520" y2="225" stroke="#e53e3e" stroke-width="3" marker-end="url(#arrowhead)"/>
  <rect x="530" y="205" width="40" height="20" fill="#fed7d7" stroke="#c53030" stroke-width="1" rx="3"/>
  <text x="550" y="220" font-size="9" text-anchor="middle" fill="#c53030" font-weight="bold">2</text>

  <line x1="520" y1="245" x2="580" y2="245" stroke="#2d3748" stroke-width="3" marker-end="url(#arrowhead)"/>
  <rect x="530" y="225" width="40" height="20" fill="#fef3c7" stroke="#92400e" stroke-width="1" rx="3"/>
  <text x="550" y="240" font-size="9" text-anchor="middle" fill="#92400e" font-weight="bold">3</text>

  <!-- Step Labels -->
  <text x="380" y="245" font-size="10" fill="#0f766e">Client Hello</text>
  <text x="720" y="245" font-size="10" fill="#c53030">Server Hello + Certificate</text>
  <text x="380" y="265" font-size="10" fill="#92400e">Key Exchange + Finished</text>

  <!-- Security Components -->
  <text x="800" y="160" font-size="16" font-weight="bold" fill="#1a365d">Security Components</text>

  <!-- JWT -->
  <rect x="750" y="180" width="120" height="50" fill="#c6f6d5" stroke="#22543d" stroke-width="2" rx="5"/>
  <text x="810" y="205" font-size="12" text-anchor="middle" fill="#22543d" font-weight="bold">JWT Token</text>
  <text x="810" y="220" font-size="10" text-anchor="middle" fill="#22543d">Stateless Auth</text>

  <!-- HttpOnly Cookies -->
  <rect x="880" y="180" width="120" height="50" fill="#fae8ff" stroke="#581c87" stroke-width="2" rx="5"/>
  <text x="940" y="200" font-size="11" text-anchor="middle" fill="#581c87" font-weight="bold">HttpOnly</text>
  <text x="940" y="215" font-size="10" text-anchor="middle" fill="#581c87" font-weight="bold">Cookies</text>

  <!-- Password Hashing -->
  <rect x="750" y="240" width="120" height="50" fill="#fed7d7" stroke="#c53030" stroke-width="2" rx="5"/>
  <text x="810" y="260" font-size="11" text-anchor="middle" fill="#c53030" font-weight="bold">bcryptjs</text>
  <text x="810" y="275" font-size="10" text-anchor="middle" fill="#c53030">Password Hash</text>

  <!-- HTTPS -->
  <rect x="880" y="240" width="120" height="50" fill="#bee3f8" stroke="#2c5282" stroke-width="2" rx="5"/>
  <text x="940" y="260" font-size="12" text-anchor="middle" fill="#2c5282" font-weight="bold">HTTPS</text>
  <text x="940" y="275" font-size="10" text-anchor="middle" fill="#2c5282">TLS 1.3</text>

  <!-- Attack Prevention -->
  <text x="200" y="650" font-size="16" font-weight="bold" fill="#1a365d">Network Attack Prevention</text>

  <!-- Attack Types -->
  <rect x="100" y="670" width="150" height="60" fill="#fed7d7" stroke="#c53030" stroke-width="2" rx="5"/>
  <text x="175" y="690" font-size="12" text-anchor="middle" fill="#c53030" font-weight="bold">Man-in-the-Middle</text>
  <text x="175" y="705" font-size="10" text-anchor="middle" fill="#c53030">TLS Encryption</text>
  <text x="175" y="720" font-size="10" text-anchor="middle" fill="#c53030">Certificate Validation</text>

  <rect x="270" y="670" width="150" height="60" fill="#fef3c7" stroke="#92400e" stroke-width="2" rx="5"/>
  <text x="345" y="690" font-size="12" text-anchor="middle" fill="#92400e" font-weight="bold">Cross-Site Scripting</text>
  <text x="345" y="705" font-size="10" text-anchor="middle" fill="#92400e">HttpOnly Cookies</text>
  <text x="345" y="720" font-size="10" text-anchor="middle" fill="#92400e">Input Sanitization</text>

  <rect x="440" y="670" width="150" height="60" fill="#fae8ff" stroke="#581c87" stroke-width="2" rx="5"/>
  <text x="515" y="690" font-size="12" text-anchor="middle" fill="#581c87" font-weight="bold">Session Hijacking</text>
  <text x="515" y="705" font-size="10" text-anchor="middle" fill="#581c87">JWT Expiration</text>
  <text x="515" y="720" font-size="10" text-anchor="middle" fill="#581c87">Secure Tokens</text>

  <rect x="610" y="670" width="150" height="60" fill="#bee3f8" stroke="#2c5282" stroke-width="2" rx="5"/>
  <text x="685" y="690" font-size="12" text-anchor="middle" fill="#2c5282" font-weight="bold">Clickjacking</text>
  <text x="685" y="705" font-size="10" text-anchor="middle" fill="#2c5282">X-Frame-Options</text>
  <text x="685" y="720" font-size="10" text-anchor="middle" fill="#2c5282">CSP Headers</text>

  <!-- Security Implementation Details -->
  <rect x="50" y="760" width="1100" height="240" fill="#f7fafc" stroke="#2d3748" stroke-width="2" rx="5"/>
  <text x="70" y="785" font-size="16" font-weight="bold" fill="#1a365d">ðŸ”’ Security Implementation Details</text>

  <text x="90" y="815" font-size="13" fill="#2d3748" font-weight="bold">Transport Layer Security:</text>
  <text x="110" y="835" font-size="12" fill="#2d3748">â€¢ TLS 1.3 with forward secrecy</text>
  <text x="110" y="855" font-size="12" fill="#2d3748">â€¢ Certificate-based authentication</text>
  <text x="110" y="875" font-size="12" fill="#2d3748">â€¢ Perfect forward secrecy (ECDHE)</text>

  <text x="90" y="900" font-size="13" fill="#2d3748" font-weight="bold">Application Security:</text>
  <text x="110" y="920" font-size="12" fill="#2d3748">â€¢ bcryptjs password hashing (10 rounds)</text>
  <text x="110" y="940" font-size="12" fill="#2d3748">â€¢ JWT with expiration and signature</text>

  <text x="600" y="815" font-size="13" fill="#2d3748" font-weight="bold">Network Protections:</text>
  <text x="620" y="835" font-size="12" fill="#2d3748">â€¢ CORS policy for cross-origin requests</text>
  <text x="620" y="855" font-size="12" fill="#2d3748">â€¢ Rate limiting and DDoS protection</text>
  <text x="620" y="875" font-size="12" fill="#2d3748">â€¢ Input validation and sanitization</text>

  <text x="600" y="900" font-size="13" fill="#2d3748" font-weight="bold">WebSocket Security:</text>
  <text x="620" y="920" font-size="12" fill="#2d3748">â€¢ Origin validation for connections</text>
  <text x="620" y="940" font-size="12" fill="#2d3748">â€¢ JWT authentication for socket access</text>

  <!-- Defense in Depth -->
  <rect x="50" y="1010" width="1100" height="60" fill="#e6fffa" stroke="#0f766e" stroke-width="2" rx="5"/>
  <text x="70" y="1030" font-size="14" font-weight="bold" fill="#0f766e">Defense in Depth Strategy:</text>
  <text x="90" y="1050" font-size="12" fill="#0f766e">Multiple security layers ensure that if one layer fails, others provide protection. Network-level encryption, application authentication, and secure protocols work together.</text>
</svg>
